<html>
<meta name='viewport' content='width=device-width, initial-scale=1'>

<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/dataTables.bootstrap.min.css">
<link rel="stylesheet" href="css/estilos.css">
<!-- Buttons DataTables -->
<link rel="stylesheet" href="css/buttons.bootstrap.min.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
<title>
    Tablero de seguimiento
</title>

<body>
    <div class="row fondo">
        <div class="col-sm-12 col-md-12 col-lg-12">
            <h1 class="text-center text-uppercase">Tablero de produccion</h1>
        </div>
    </div>
    <br>
    <button id="btn_mostar" type="button" class="btn btn-primary"  onClick="ocultars()"><i class='fa fa-plus'></i> Agregar Produccion</button>
    <button onclick="location.href='tablero.html';" class='regresar btn btn-primary'><i class='fa fa-home'></i> Home</button>
    <button role="link" onclick="location.href='maquinaria.html';" class='maquinas btn btn-primary'><i
            class='fa fa-steam'></i>  Maquinaria</button>
    <!-- Hacer funcion de redireccionamiento a consulta de operadores -->
    <button role="link" onclick="location.href='operadores.html';" class='operadores btn btn-primary'><i
        class='fa fa-users'></i>  Operadores</button>
        <button role="link" onclick="location.href='capacidad.html';" class='operadores btn btn-primary'><i
            class='fa fa-trophy'></i>  Capacidad actual</button>
    <button role="link" onclick="location.href='herramentacion.html';" class='btn btn-primary'><i
            class='fa fa-simplybuilt'></i>  Herramentacion</button>
    <button onclick="goBack()" class='regresar btn btn-primary'><i class='fa fa-home'></i></button>
    <br>
    <br>
    <div class="row">

        <div id="cuadro2" class="col-sm-12 col-md-12 col-lg-12 ocultar">
            <form id="mainform" class="form-horizontal" action="" method="POST">
                <div class="form-group">
                    <h3 class="col-sm-offset-2 col-sm-8 text-center">
                        Registro de Orden de Produccion</h3>
                </div>
                <div class="form-group">
                    <label for="id_mpvi" class="col-sm-2 control-label">Tipo de produccion :</label>
                    <div class="col-sm-8"><input id="tipo_produccion" name="tipo_produccion" type="text" class="form-control" autofocus></div>
                </div>
                <div class="form-group">
                    <label for="modelo" class="col-sm-2 control-label">Cuando solicito :</label>
                    <div class="col-sm-8"><input id="cuando_solicito" name="cuando_solicito" type="date" class="form-control" autofocus></div>
                </div>
                <div class="form-group">
                    <label for="marca" class="col-sm-2 control-label">Orden de produccion :</label>
                    <div class="col-sm-8"><input id="orden_produccion" name="orden_produccion" type="text" class="form-control"></div>
                </div>
                <div class="form-group">
                    <label for="tipo_maquina" class="col-sm-2 control-label">Numero de parte :</label>
                    <div class="col-sm-8"><input id="numero_parte" name="numero_parte" type="text" class="form-control" maxlength="8"></div>
                </div>
                <div class="form-group">
                    <label for="tipo_maquina" class="col-sm-2 control-label">Cantidad requerida :</label>
                    <div class="col-sm-8"><input id="cantidad_requerida" name="cantidad_requerida" type="text" class="form-control" maxlength="8"></div>
                </div>
                <div class="form-group">
                    <label for="tipo_maquina" class="col-sm-2 control-label">Fecha requerida :</label>
                    <div class="col-sm-8"><input id="fecha_requerida" name="fecha_requerida" type="date" class="form-control" maxlength="8"></div>
                </div>
                <div class="form-group">
                    <label for="tipo_maquina" class="col-sm-2 control-label">Numero de operadores :</label>
                    <div class="col-sm-8"><input id="numero_operacion" name="numero_operacion" type="text" class="form-control" maxlength="8"></div>
                </div>
                <div class="form-group">
                    <label for="tipo_maquina" class="col-sm-2 control-label">UPH :</label>
                    <div class="col-sm-8"><input id="UPH" name="UPH" type="text" class="form-control" maxlength="8">
                    </div>
                </div>
                <div class="form-group">
                    <label for="tipo_maquina" class="col-sm-2 control-label">Fecha de Inicio de Produccion :</label>
                    <div class="col-sm-8"><input id="fecha_inicio" name="fecha_inicio" type="date" class="form-control" maxlength="8"></div>
                </div>
                <div class="form-group">
                    <label for="tipo_maquina" class="col-sm-2 control-label">Fecha de Termino de Produccion :</label>
                    <div class="col-sm-8"><input id="fecha_fin" name="fecha_fin" type="date" class="form-control" maxlength="8"></div>
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-8">
                        <input id="guardar" type="button" class="btn btn-primary" value="Guardar">
                    </div>
                </div>
            </form>

        </div>
        </form>
        <div class="col-sm-offset-2 col-sm-8">
            <p class="mensaje"> </p>
        </div>

    </div>
    </div>

    <div class="row">
        <div id="cuadro1" class="col-sm-12 col-md-12 col-lg-12">
            <div class="col-sm-offset-2 col-sm-8">
                <h3 class="text-center"> <small class="mensaje"></small></h3>
            </div>
            <div class="table-responsive col-sm-12">

                <table id="dt_procesos" class="table table-bordered table-hover" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th>ID. Produccion</th>
                            <th>Tipo produccion</th>
                            <th>Cuando solicito</th>
                            <th>Orden de produccion</th>
                            <th>Numero de parte</th>
                            <th>Cantidad requerida</th>
                            <th>Fecha requerida</th>
                            <th>No. Operacion</th>
                            <th>UPH</th>
                            <th>Fecha Inicio Produccion</th>
                            <th>Fecha Fin Produccion</th>
                            <th>Metricas</th>
                            <th>Ingenieria</th>
                            <th>Calidad</th>
                            <th>Forma 72</th>
                            <th>Opciones</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal de la forma 72 -->
    <div class="modal fade bd-example-modal-lg" id="modal_dash">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class='modal-header'>
                    <h4>Reporte diario de produccion</h4><button class='close' id='cerrar72'>×</button>
                    <br>
                </div>
                <div class="modal-body">

                    <p style="text-align:right">Fecha: <label id="fechaactual"></label></p>
                    <!-- Tabla para obtener los datos de la orden de produccion -->
                    <table class='table table-hove table-condensed table-bordered'>
                        <thead class="thead-dark">
                            <tr>
                                <th colspan="2">Datos de produccion</th>
                            </tr>
                            <tr>

                                <td>Empleado:</td>
                                <td><input type='text' id='nombre_empleado' value=''>
                                    <input type='hidden' id='id_empleado'><button id="seleccionaempleado" class="btn-primary btn-sm">+</button></td>
                            </tr>
                            <tr>
                                <td>Orden de Producción:</td>
                                <td><input type='text' id='orden_72' value=""></td>
                                <input type='hidden' id='id_orden'>
                            </tr>
                            <tr>
                                <td>Turno: </td>
                                <td>
                                    <select id="turnos">
                                      <option value="M">Matutino</option>
                                      <option value="V">Vespertino</option>
                                      </select>
                                </td>
                            </tr>
                        </thead>
                    </table>
                    <br><br>
                    <!-- Tabla de checklist de inicio de turno -->
                    <table class='table table-hove table-condensed table-bordered'>
                        <thead class="thead-dark">
                            <tr>
                                <th>Checklist inicio de turno:</th>
                                <th>Check</th>
                            </tr>
                            <tr>
                                <td>Piezas PAP: </td>
                                <td><input type="checkbox" id="PAP" value="PAP" class="chk72"></td>
                            </tr>
                            <tr>
                                <td>Paquetes de operaciones completo:</td>
                                <td><input type="checkbox" id="POC" value="POC" class="chk72"></td>
                                </td>
                            </tr>
                            <tr>
                                <td>Area de trabajo limpia:</td>
                                <td><input type="checkbox" id="ATL" value="ATL" class="chk72"></td>
                            </tr>
                            <tr>
                                <td>Caja de scrap y reproceso sin material:</td>
                                <td><input type="checkbox" id="SCRAP" value="SCRAP" class="chk72"></td>
                            </tr>
                            <tr>
                                <td>Equipo de medicion vigente:</td>
                                <td><input type="checkbox" id="EMV" value="EMV" class="chk72"></td>
                            </tr>
                    </table>
                    <br>
                    <!-- Tabla donde se registra el progreso de la produccion-->
                    <table id="tabla72" class="table table-hove  table-condensed table-bordered responsive-table">
                        <thead class="thead-dark">
                            <tr>
                                <th colspan="5">Registro de entrada</th>
                            </tr>
                            <tr>
                                <td>Fecha inicio</td>
                                <td>Fecha fin</td>
                                <td>Cantidad producida</td>
                                <td>Reproceso</td>
                                <td>Scrap</td>
                            </tr>
                            <tbody>
                            </tbody>
                        </thead>
                    </table>
                    <button data-toggle="modal" data-target="#modaldeforma72" text-align='center' class="btn btn-default btn-lg btn-info">Agregar registro en tabla</button>
                    <br>
                    <!-- Tabla donde se registran los paros de las maquinas -->
                    <table id="tablaparos" class="table table-bordered table-hover" cellspacing="0" cellpadding="0" width="100%">
                        <thead class="thead-dark">
                            <tr>
                                <th colspan="2">Agregar paro de maquinas</th>
                            </tr>
                            <tr>
                                <td width="30%">Tiempo de demora (Horas)</td>
                                <td width="70%">Motivo</td>
                            </tr>
                            <tbody>
                            </tbody>
                        </thead>
                    </table>
                    <button data-toggle="modal" data-target="#modalparo" text-align='center' class="btn btn-default btn-lg btn-info">Agregar paro de maquinas</button>
                    <br><br>
                    <!-- Boton para guardar registro -->
                    <button id="guardala72" class="btn btn-primary btn-lg btn-block">Guardar registro</button>
                    <br><br>
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>

    <!--Modal de herramentacion-->

    <div class="modal fade bd-example-modal-lg" id="modal_maquinas_asignadas">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class='modal-header'>
                    <h4>Maquinas Asignadas</h4><button class='close' id='cerrar72'>×</button>
                    <br>
                    <button id="listar_maquinas" type='button' class='herrmentacion btn btn-primary'><i class='fa fa-plus-circle'></i> Agregar Maquina</button>
                </div>
                <div class="modal-body table-responsive">

                    <table id="dt_maquinas_asignadas" class="table table-bordered table-hover" cellspacing="0" width="100%">
                        <thead>
                            <tr>
                                <td>ID. Herramentacion</td>
                                <td>ID. Produccion1</td>
                                <td>ID. Maquina1</td>
                                <td>Maquina</td>
                                <td>Tipo Maquina</td>
                                <td>Tiempo Operacion</td>
                                <td>Tiempo Ciclo</td>
                                <td>Opciones</td>
                            </tr>
                        </thead>
                    </table>

                </div>
            </div>
        </div>
    </div>

    <!--modal agregar maquina asignada-->

    <div class="modal fade bd-example-modal-lg" id="modal_agregar_maquina_asignada">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class='modal-header'>
                    <h4>Agregar Maquina</h4><button class='close' data-dismiss="modal">×</button>
                    <br>
                </div>
                <div class="modal-body table-responsive">
                    <table id="dt_maquinas" class="table table-bordered table-hover" cellspacing="0" width="100%">
                        <thead>
                            <tr>
                                <th>ID. Maquina</th>
                                <th>Maquina</th>
                                <th>Tipo</th>
                                <th></th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!--Modal validacion maquina-->

    <form id="agregar_maquina_asignada">

        <div class="modal fade" id="modal_validar_maquina" tabindex="-1" role="dialog" aria-labelledby="modal_validar_maquina">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="modalEliminarLabel">Asignar Maquina</h4>
                        <input type="hidden" id="id_maquina" name="id_maquina" value="">
                    </div>
                    <div class="form-group col-md-8">
                        <input type="hidden" id="id_produccion_maquina" name="id_produccion_maquina" value="">
                        <label for="modelo" class="control-label">Tiempo Operacion : </label>
                        <input id="tiempo_operacion" name="tiempo_operacion" type="text" class="form-control" autofocus>
                    </div>
                    <div class="form-group col-md-8">
                        <label for="modelo" class="control-label">Tiempo Ciclo</label>
                        <input id="tiempo_ciclo" name="tiempo_ciclo" type="text" class="form-control" autofocus>
                    </div>

                    <div class="modal-footer">
                        <div style="text-align: left;">
                            <label>Esta seguro de agregar la maquina?<strong data-name=""></strong></label>
                        </div>
                        <button type="button" id="agregar_maquina" class="btn btn-primary" data-dismiss="modal">Aceptar</button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
    </div>

    <!-- Modal para agregar datos a la tabla -->
    <div class="modal fade bd-example-modal-lg" id="modaldeforma72">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class='modal-header'>
                    <h4>Agregue datos a la tabla</h4>
                    <button id="cerrarregistro" style="text-align:right" class="btn btn-danger">×</button>
                </div>
                <div class="modal-body">

                    <!-- Tabla para introducir la hora -->
                    <table class='table table-hove table-condensed table-bordered'>
                        <thead class="thead-dark">
                            <tr>
                                <th colspan="2">Fecha</th>
                            </tr>
                            <tr>
                                <!-- Dato de entrada de rango de fecha -->
                                <td><input id="rango" type="text" class="datetime" name="rango" value=""></td>
                                <!-- Metricas auto calculables en horas trabajadas -->
                                <td><input id="hrs" type="text" disabled="true" value="horas"></td>
                            </tr>
                    </table>
                    <!-- Tabla para introducir datos de produccion -->
                    <table id="tabla721" class="table table-hove  table-condensed table-bordered responsive-table">
                        <thead class="thead-dark">
                            <tr>
                                <th colspan="3">Datos de entrada</th>
                            </tr>
                            <tr>
                                <td>Cantidad Producida</td>
                                <td>Reproceso</td>
                                <td>Scrap</td>
                            </tr>
                            <tr>
                                <td><input id="progress" type="number" name="progreso"></td>
                                <td><input id="reproceso" type="number" name="reproceso"></td>
                                <td><input id="scrap" type="number" name="scrap"></td>
                            </tr>
                        </thead>
                    </table>
                    <button id="guardaentabla" class="btn btn-default btn-lg btn-info">Aceptar</button>
                    <br>
                    <br>
                </div>
            </div>
        </div>
    </div>


    <!--Modal para seleccionar empleado-->
    <div class="modal fade bd-example-modal-lg" id="modalempleados" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class='modal-header'>
                    <h4>Seleccione el operador</h4><button class='close' id='cerrarempleado'>×</button>
                </div>
                <div class="modal-body">
                    <br>
                    <table id="tablaempleados" class="table table-bordered table-hover" cellspacing="0" width="100%">
                        <thead class="thead-dark">
                            <tr class="active">
                                <th>ID Operador</th>
                                <th>Nombre</th>
                                <th>Apellido</th>
                                <th>Turno</th>
                                <th>Seleccionar</th>
                            </tr>
                        </thead>
                    </table>

                </div>
            </div>
        </div>
    </div>

    <!--Modal Metricas-->

    <div class="modal fade bd-example-modal-lg" id="modal_metrica">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class='modal-header'>
                    <h4>Metricas de Orden de Produccion</h4><button class='close' id='cerrar72'>×</button>
                    <br>
                </div>
                <div class="modal-body table-responsive">

                    <table id="dt_metricas" class="table table-bordered table-hover" cellspacing="0" width="100%">
                        <thead>
                            <tr>
                                <td>ID. Orden</td>
                                <td>Fecha limite</td>
                                <td>Dias Necesarios para terminar la Produccion</td>
                                <td>Cantidad Requerida</td>
                                <td>Piezas Fabricadas al momento</td>
                                <td>Porcentaje de Avance</td>
                                <td>Dias necesarios para terminar la produccion</td>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Agregar paro de maquina -->
    <div class="modal fade bd-example-modal-lg" id="modalparo" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class='modal-header'>
                    <h4>Agregue el motivo de paro de maquina</h4>
                    <button id="closemodalparo" style="text-align:right" class="btn btn-danger">×</button>
                </div>
                <div class="modal-body">

                    <label for="comment">Seleccione el intervalo de paro de maquina</label>
                    <input class="datetime" id="tiempoparo">
                    <br>
                    <label for="comment">Comment:</label>
                    <textarea class="form-control" rows="5" id="comment"></textarea>
                    <br>
                    <br>
                    <button id="guardaparo" class="btn btn-default btn-lg btn-info">Guardar</button>
                    <br>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal para calidad -->
    <div class='modal fade bd-example-modal-lg' id='modalcalidad' tabindex='1' role='dialog' aria-labelledby='myExtraLargeModalLabel' aria-hidden='true'>
        <div class='modal-dialog modal-lg'>
            <div class='modal-content'>
                <div class='modal-header'>
                    <button class="btn btn-danger" style="float:right;" id='cerrarcalidad'><i
                            class="fa fa-times"></i></button>
                    <h1>Calidad</h1>
                    <input type="hidden" id="ordendeproduccion">
                </div>
                <div class="modal-body">
                    <table class="table table-hove  table-condensed table-bordered responsive-table">
                        <thead class="thead-dark">
                            <tr>
                                <td><label>Autorizo la liberacion: </label></td>
                                <td><label>Fecha de liberacion</label></td>
                                <td><label>Tiempo de liberacion</label></td>
                            </tr>
                            <tr>
                                <td><input id="nombre_calidad" type="text" placeholder="nombre"></td>
                                <td><input id="fecha_calidad" type="text" class="onlydate"></td>
                                <td><input id="tiempo_liberacion" type="number" placeholder="minutos"></td>
                            </tr>
                        </thead>
                    </table>
                    <button id="guarda_calidad" class="btn btn-primary btn-lg btn-block">Guardar registro</button>
                    <h2>Liberaciones</h2>
                    <table id="tabla_calidad" class="table table-hove  table-condensed table-bordered responsive-table">
                        <thead class="thead-dark">
                            <tr>
                                <td><label>id_calidad</label></td>
                                <td><label>id_operacion</label></td>
                                <td><label>responsable</label></td>
                                <td><label>fecha_liberacion</label></td>
                                <td><label>tiempo_liberacion</label></td>
                                <td><label>opciones</label></td>
                            </tr>
                        </thead>
                    </table>
                    <!-- Boton para guardar registro -->
                    <br><br>

                    <br>

                </diV>

            </div>
        </div>
    </div>

    <div class='modal fade bd-example-modal-lg' id='modaleditacalidad' tabindex='1' role='dialog' aria-labelledby='myExtraLargeModalLabel' aria-hidden='true'>
        <div class='modal-dialog modal-lg'>
            <div class='modal-content'>
                <div class='modal-header'><button id="closemodaleditacalidad" style="float:right;" class="btn btn-danger"><i
                class="fa fa-times"></i></button>
                    <h4>Editar registro de calidad</h4>

                </div>
                <div class="modal-body">
                    <table class="table table-hove  table-condensed table-bordered responsive-table">
                        <thead class="thead-dark">
                            <tr>
                                <td><label>Autorizo la liberacion: </label></td>
                                <td><label>Fecha de liberacion</label></td>
                                <td><label>Tiempo de liberacion</label></td>
                            </tr>
                            <tr>
                                <input type="hidden" id="id_calidad">
                                <td><input id="resp" type="text" placeholder="nombre"></td>
                                <td><input id="fechalib" type="text" class="onlydate"></td>
                                <td><input id="tiempolib" type="number" placeholder="minutos"></td>
                            </tr>
                        </thead>
                    </table>

                    <button id="act_calidad" class="btn btn-default btn-lg btn-info">Actualizar</button>
                    <br>
                </div>
            </div>
        </div>
    </div>

    <form id="frmEliminarUsuario" action="">
        <input type="hidden" id="id_produccion2" name="id_produccion2" value="">

        <div class="modal fade" id="modalEliminar" tabindex="-1" role="dialog" aria-labelledby="modalEliminarLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="modalEliminarLabel">Eliminar Orden de Produccion</h4>
                    </div>
                    <div class="modal-body">
                        Esta seguro de eliminar la Orden de Produccion?<strong data-name=""></strong>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="eliminar1" class="btn btn-primary" data-dismiss="modal">Aceptar</button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <!-- Modal para editar orden de produccion -->

    <div class="modal fade bd-example-modal-lg" id="modalEditar" tabindex="-1" role="dialog" aria-labelledby="modalEditarLabel">
        <div class="modal-dialog modal-lg">

            <div class="modal-content">
                <div class="container">
                    <br>
                    <h4 class="modal-title" id="modalEliminarLabel"> Modificar Orden de Produccion </h4>
                    <br>
                    <form id="mainform1" class="form-horizontal" action="" method="POST">
                        <div class="form-group">
                            <input id="id_produccion1" name="id_produccion1" type="hidden">
                            <label for="id_mpvi" class="col-sm-2 control-label">Tipo de produccion :</label>
                            <div class="col-sm-6"><input id="tipo_produccion1" name="tipo_produccion1" type="text" class="form-control" autofocus></div>
                        </div>
                        <div class="form-group">
                            <label for="modelo" class="col-sm-2 control-label">Cuando solicito :</label>
                            <div class="col-sm-6"><input id="cuando_solicito1" name="cuando_solicito1" type="date" class="form-control" autofocus></div>
                        </div>
                        <div class="form-group">
                            <label for="marca" class="col-sm-2 control-label">Orden de produccion :</label>
                            <div class="col-sm-6"><input id="orden_produccion1" name="orden_produccion1" type="text" class="form-control"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Numero de parte :</label>
                            <div class="col-sm-6"><input id="numero_parte1" name="numero_parte1" type="text" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Cantidad requerida :</label>
                            <div class="col-sm-6"><input id="cantidad_requerida1" name="cantidad_requerida1" type="text" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Fecha requerida :</label>
                            <div class="col-sm-6"><input id="fecha_requerida1" name="fecha_requerida1" type="date" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Numero de operacion :</label>
                            <div class="col-sm-6"><input id="numero_operacion1" name="numero_operacion1" type="text" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">UPH :</label>
                            <div class="col-sm-6"><input id="UPH1" name="UPH1" type="text" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Fecha de Inicio de Produccion
                                :</label>
                            <div class="col-sm-6"><input id="fecha_inicio1" name="fecha_inicio1" type="date" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Fecha de Termino de Produccion
                                :</label>
                            <div class="col-sm-6"><input id="fecha_fin1" name="fecha_fin1" type="date" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-8">
                                <input id="guardar1" type="button" class="btn btn-primary" value="Actualizar">
                                <button type="button" class="btn btn-default cerrarModal">Cerrar</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!--Modal Herramentación-->

    <div class="modal fade bd-example-modal-lg" id="modalHerramentacion" tabindex="-1" role="dialog" aria-labelledby="modalEditarLabel">
        <div class="modal-dialog modal-lg">

            <div class="modal-content">
                <div class="container">
                    <br>
                    <h4 class="modal-title" id="modalEliminarLabel"> Herramentar Maquina </h4>
                    <br>
                    <form id="form_herramentacion" class="form-horizontal">
                        <div class="form-group">
                            <label for="id_mpvi" class="col-sm-2 control-label">Maquina :</label>
                            <div class="col-sm-6"><input id="maquina_herramentacion" name="maquina_herramentacion" type="text" class="form-control" readonly> </div>
                            <div class="col-sm-6"><input id="id_maquina_herramentacion" name="id_maquina_herramentacion" type="hidden" class="form-control" autofocus></div>
                        </div>
                        <div class="form-group">
                            <label for="modelo" class="col-sm-2 control-label">Operador :</label>
                            <div class="col-sm-2"><input id="operador_herramentacion" name="operador_herramentacion" type="text" class="form-control" readonly></div>
                            <button id="btnOperador" type="button" class="btn btn-primary"><i class="fa fa-user"></i> </button>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-6"><input id="id_operador_herramentacion" name="id_operador_herramentacion" type="hidden" class="form-control" autofocus></div>
                        </div>
                        <div class="form-group">
                            <label for="marca" class="col-sm-2 control-label">Fecha de Herramentacion :</label>
                            <div class="col-sm-6"><input id="fecha_herramentacion" name="fecha_herramentacion" type="date" class="form-control"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Tiempo de Herramentacion :</label>
                            <div class="col-sm-6"><input id="tiempo_herramentacion" name="tiempo_herramentacion" type="text" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Reproceso :</label>
                            <div class="col-sm-6"><input id="reproceso_herramentacion" name="reproceso_herramentacion" type="number" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Scrap :</label>
                            <div class="col-sm-6"><input id="scrap_herramentacion" name="scrap_herramentacion" type="number" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Observaciones :</label>
                            <div class="col-sm-6"><input id="observacion_herramentacion" name="observacion_herramentacion" type="text" class="form-control" maxlength="8"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Paquete de OP :</label>
                            <div class="col-sm-6"><input id="paquete_op" name="paquete_op" type="checkbox" class="form-control" maxlength="2"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">IT :</label>
                            <div class="col-sm-6"><input id="it_herramentacion" name="it_herramentacion" type="checkbox" class="form-control" maxlength="2"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">Diagrama de Flujo :</label>
                            <div class="col-sm-6"><input id="diagrama_herramentacion" name="diagrama_herramentacion" type="checkbox" class="form-control" maxlength="2"></div>
                        </div>
                        <div class="form-group">
                            <label for="tipo_maquina" class="col-sm-2 control-label">AMEF :</label>
                            <div class="col-sm-6"><input id="amef_herramentacion" name="amef_herramentacion" type="checkbox" class="form-control" maxlength="2"></div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-8">
                                <input id="guardar_herramentacion" type="button" class="btn btn-primary" value="Herramentar">
                                <button type="button" id="cerrar_herramentacion" class="btn btn-default cerrarModal">Cerrar</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!--Modal operador herramentar-->

    <div class="modal fade bd-example-modal-lg" id="modalOperador">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class='modal-header'>
                    <h4>Operadores</h4><button class='close' id='cerrar72'>×</button>
                    <br>
                </div>
                <div class="modal-body table-responsive">
                    <table id="dt_cliente" class="table table-bordered table-hover" cellspacing="0" width="100%">
                        <thead>
                            <tr>
                                <th>Id operador</th>
                                <th>Nombre</th>
                                <th>Apellido</th>
                                <th>Opciones</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>

</body>



<script>
    $(document).ready(function() {
        listar();
    });
    $("#act_calidad").on("click", function() {
        var nombre = $("#resp").val();
        var fecha = $("#fechalib").val();
        var tiempo = $("#tiempolib").val();
        var id_calidad = $("#id_calidad").val();
        query = "UPDATE calidad SET responsable = '" + nombre + "', fecha_liberacion ='" + fecha + "', tiempo_liberacion=" + tiempo + " where id_calidad =" + id_calidad;
        $.ajax({
            url: "guarda_registro72.php",
            type: "POST",
            data: {
                query: query
            }
        });
        location.reload();
    })


    //funcion para listar las ordenes de compra que estan en proceso actualmente,
    var listar = function() {
        var table = $("#dt_procesos").DataTable({
            "destroy": true,
            "ajax": {
                "method": "POST",
                "url": "listaordenproduccion.php"
            },
            "columns": [{
                "data": "id_produccion",
                "visible": false
            }, {
                "data": "tipo_produccion"
            }, {
                "data": "fecha_solicitud"
            }, {
                "data": "orden_produccion"
            }, {
                "data": "numero_parte"
            }, {
                "data": "cantidad_requerida"
            }, {
                "data": "fecha_requerida"
            }, {
                "data": "numero_operacion"
            }, {
                "data": "UPH"
            }, {
                "data": "fecha_inicio"
            }, {
                "data": "fecha_fin"
            }, {
                "defaultContent": "<button id='btn_metricas'type='button' class='btn btn-primary'><i class='fa fa-bar-chart'></i> Metrica</button>"
            }, {
                "defaultContent": "<button id='maquinas_asignadas1' class='btn btn-primary' ><i class='fa fa-gavel'></i> Ingenieria</button>"
            }, {
                "defaultContent": "<button id='calidad'class='btn btn-primary'>Calidad</button>"
            }, {
                "defaultContent": "<button id='forma'class='btn btn-primary'>Forma 72</button>"
            }, {
                "defaultContent": "<button  type='button' class='editar btn btn-primary' data-toggle='modal' data-target='#modalEditar' ><i class='fa fa-pencil-square-o'></i></button>	<button id='eliminamesta' type='button' class='eliminar btn btn-danger' data-toggle='modal' data-target='#modalEliminar' ><i class='fa fa-trash-o'></i></button>"
            }]
        });

        obtener_orden("#dt_procesos tbody", table);
        obtener_datos("#dt_procesos tbody", table);
        //Obtiene datos para modal de calidad.
        obtener_datos_calidad("#dt_procesos tbody", table);
        obtener_datos_eliminar("#dt_procesos tbody", table);
        obtiene_datos_ingenieria("#dt_procesos tbody", table);
        obtiene_datos_metricas("#dt_procesos tbody", table);
    }

    var listar_maquinas_asignadas = function(temporal) {
        var table = $("#dt_maquinas_asignadas").DataTable({
            "destroy": true,
            "ajax": {
                "method": "POST",
                "url": "listar_maquinas_asignadas.php",
                "data": {
                    "produccion": temporal
                }
            },
            "columns": [{
                "data": "id_reservada",
                "visible": false
            }, {
                "data": "id_produccion",
                "visible": false
            }, {
                "data": "id_maquina",
                "visible": false
            }, {
                "data": "maquina"
            }, {
                "data": "tipo_maquina"
            }, {
                "data": "tiempo_operacion"
            }, {
                "data": "tiempo_ciclo"
            }, {
                "defaultContent": "<button ' class='editar btn btn-primary' data-toggle='modal' data-target='#modalEditar' ><i class='fa fa-pencil-square-o'></i></button>	<button id='eliminamesta' type='button' class='eliminar btn btn-danger' data-toggle='modal' data-target='#modalEliminar' ><i class='fa fa-trash-o'></i></button>    <button id='herramentar_maquina' type='button type='button' class='herramentacion btn btn-primary' data-toggle='modal' data-target='#modalHerramentacion' ><i class='fa fa-simplybuilt'></i> Herramentar</button>"
            }]
        });
        obtiene_datos_herramentar("#dt_maquinas_asignadas tbody", table);
        // obtener_datos_maquina_reservada("#dt_herramentacion tbody", table);
        // obtener_datos_eliminar_maquina_reservada("#dt_herramentacion tbody", table);
    }
    var listar_maquinas = function() {
        var table = $("#dt_maquinas").DataTable({
            "destroy": true,
            "ajax": {
                "method": "POST",
                "url": "lista_maquina.php"
            },
            "columns": [{
                "data": "id_maquina",
                "visible": false
            }, {
                "data": "maquina"
            }, {
                "data": "tipo_maquina"
            }, {
                "defaultContent": "<button id='validar_maquina' type='button' class='editar btn btn-primary' data-toggle='modal' data-target='#modal_validar_maquina' ><i class='fa fa-plus-square-o'></i></button>"
            }]
        });

        obtener_datos_maquina_validacion("#dt_maquinas tbody", table);
    }

    var listarOperador = function() {
        var table = $("#dt_cliente").DataTable({
            "destroy": true,
            "ajax": {
                "method": "POST",
                "url": "lista_operador.php"
            },
            "columns": [{
                "data": "id_operador",
                "visible": false
            }, {
                "data": "nombre_operador"
            }, {
                "data": "apellido_operador"
            }, {
                "defaultContent": "<button id='btnSeleccionOperador' type='button' class='btn btn-primary'><i class='fa fa-user-plus'></i></button>"
            }]
        });
        obtener_Operador("#dt_cliente tbody", table);
    }


    var listar_metricas = function(temp_metricas) {
        var table = $("#dt_metricas").DataTable({
            "destroy": true,
            "ajax": {
                "method": "POST",
                "url": "listar_metricas.php",
                "data": {
                    "produccion2": temp_metricas
                }
            },
            "columns": [{
                "data": "id_produccion",
                "visible": false
            }, {
                "data": "fecha_requerida"
            }, {
                "data": "fecha_requerida",
                render: function(data, type, row) {
                    let today = new Date().toISOString().slice(0, 10);
                    const date2 = new Date(data);
                    var fecha1 = moment(today);
                    var fecha2 = moment(date2);
                    var temporal = fecha2.diff(fecha1, 'days');
                    var tmp = "";
                    if (temporal < 0) {
                        tmp = " Dias atrasado";
                    } else {
                        tmp = " Dias Restantes";
                    }
                    return temporal + tmp;
                }
            }, {
                "data": "cantidad_requerida"
            }, {
                render: function(data, type, row) {
                    var cantidad = row.cantidad;
                    if (cantidad == 0) {
                        return 0;
                    } else {
                        return cantidad;
                    }
                }
            }, {

                render: function(data, type, row) {
                    var realizado_porcentaje = (row.cantidad * 100) / row.cantidad_requerida;
                    return realizado_porcentaje + "%";
                }
            }, {
                render: function(data, type, row) {
                    var dias_necesarios = ((row.cantidad_requerida - row.cantidad) / row.UPH) / 14;
                    return dias_necesarios.toFixed(4);
                }
            }]
        });
    }



    var obtener_datos_maquina_validacion = function(tbody, table) {
        $(tbody).on("click", "#validar_maquina", function() {
            var data = table.row($(this).parents("tr")).data();
            var id_maquina = $("#id_maquina").val(data.id_maquina);
        });

    }
    var obtiene_datos_ingenieria = function(tbody, table) {
        $(tbody).on("click", "#maquinas_asignadas1", function() {
            var data1 = table.row($(this).parents("tr")).data();
            var temporal = data1.id_produccion;
            $("#id_produccion_maquina").val(data1.id_produccion);
            listar_maquinas_asignadas(temporal);
            $("#modal_maquinas_asignadas").modal()


        });
    }

    var obtiene_datos_metricas = function(tbody, table) {
        $(tbody).on("click", "#btn_metricas", function() {
            var data4 = table.row($(this).parents("tr")).data();
            var temp_metricas = data4.id_produccion;
            listar_metricas(temp_metricas);
            $("#modal_metrica").modal()
        });
    }

    var obtiene_datos_herramentar = function(tbody, table) {
        $(tbody).on("click", "#herramentar_maquina", function() {
            var data2 = table.row($(this).parents("tr")).data();
            $("#id_maquina_herramentacion").val(data2.id_maquina);
            $("#maquina_herramentacion").val(data2.maquina);
        });
    }

    var obtener_Operador = function(tbody, table) {
        $(tbody).on("click", "#btnSeleccionOperador", function() {
            var data3 = table.row($(this).parents("tr")).data();
            $("#id_operador_herramentacion").val(data3.id_operador);
            $("#operador_herramentacion").val(data3.nombre_operador);
            $("#modalOperador").modal('hide')
        });
    }


    $("#listar_maquinas").on("click", function() {
        listar_maquinas();
        $("#modal_agregar_maquina_asignada").modal();
    });

    $("#agregar_maquina").on("click", function() {
        $.ajax({
            type: "POST",
            url: "agregar_maquina_reservada.php",
            data: $("#agregar_maquina_asignada").serialize(),
            success: function(data) {
                console.log(data);
            }
        })
        location.reload();

    });

    //funciones de pedro  
    function ocultars() {
        var elemento = document.getElementById('cuadro2');

        if (elemento.classList.contains('ocultar')) {
            elemento.classList.remove('ocultar');

        } else {
            elemento.classList.add('ocultar');
        }
    }

    /* Funcion para guardar la forma 72 */
    $("#guardala72").on("click", function() {
        //Pendiente crear funcion para verificar si la tabla de registros esta vacia.

        //obtiene los ckecboxs que son chekeados de la clase 
        var pap = 0;
        var poc = 0;
        var atl = 0;
        var scrap = 0;
        var emv = 0;
        var equis = $('.chk72:checkbox:checked').each(function() {
            var sThisVal = $(this).val();
            switch (sThisVal) {
                case "PAP":
                    pap = 1;
                    break;
                case "POC":
                    poc = 1;
                    break;
                case "ATL":
                    atl = 1;
                    break;
                case "SCRAP":
                    scrap = 1;
                    break;
                case "emv":
                    emv = 1;
                    break;
            }
        });
        //obtiene los datos necesarios restantes
        var id_empleado = $("#id_empleado").val();
        var orden_72 = $("#id_orden").val();
        var turnos =document.getElementById('turnos').value;
        //var turnos = temp.value;
        if (id_empleado == "" || orden_72 == "") {
            alert("Datos Faltantes: \nAsegurese de llenar todos los datos");
        } else {
            var query = "insert into forma_72 values(NULL," + orden_72 + "," + id_empleado + ",NOW()" + "," + pap + "," + poc + "," + atl + "," + scrap + "," + emv + ",'"+turnos+"');";
            console.log(query);
              $.ajax({
                url: "guarda72.php",
                type: "POST",
                data: {
                    query: query
                },
                success: function(data) {
                    guardaregistros(data);
                   /*  guardaparos(data);
                    location.reload(); */
                }
            }); 
 
        }


    });

    //Funcion para guardar los registros de la tabla de la forma 72
    function guardaregistros(data) {
        $('#tabla72 tbody tr').each(function() {
            var inicio = $(this).find(".inicio1").html();
            var finn = $(this).find(".fin1").html();
            var cantidad = $(this).find(".cantidad1").html();
            var reproceso1 = $(this).find(".reproceso1").html();
            var scrap1 = $(this).find(".scrap1").html();

            if (typeof data !== 'undefined' || typeof inicio !== 'undefined' || typeof fin !== 'undefined') {
                if (typeof cantidad == 'undefined') {
                    cantidad = 0;
                }
                if (typeof reproceso1 == 'undefined') {
                    reproceso1 = 0;
                }
                if (typeof scrap1 == 'undefined') {
                    scrap1 = 0;
                }
                query = "insert into registro_72 values (NULL," + data + ",'" + inicio + "','" + finn + "'," + cantidad + "," + reproceso1 + "," + scrap1 + ");";
                console.log(query);
                 $.ajax({
                    url: 'guarda_registro72.php',
                    type: 'post',
                    data: {
                        "query": query
                    },
                    success: function(data2) {}
                }); 
            } else {
                alert("Error no se puede guardar sin tarea ligada o sin fecha");
            }
        });
    }

    //Funcion para guardar los paros de las maquinas
    function guardaparos(data) {
        var rowCount = $('#tablaparos >tbody >tr').length;
        if (rowCount > 0) {
            $('#tablaparos tbody tr').each(function() {
                var diferencia = $(this).find(".diferencia").html();
                var comentario = $(this).find(".comentario").html();
                var query = "insert into paro_maquinas values(NULL," + data + "," + diferencia + ",'" + comentario + "') ;";

                $.ajax({
                    url: "guarda_registro72.php",
                    type: "POST",
                    data: {
                        "query": query
                    }
                });
            });
        }
    }

    //guarda Herramentacion

    $('#guardar_herramentacion').click(function() {
        $.ajax({
            type: "POST",
            url: "guardar_herramentacion.php",
            data: $("#form_herramentacion").serialize(),
            success: function(result) {
                $("#modalHerramentacion").modal('hide')
                alert("Registro guardado exitosamente");
            }
        })

    })


    //actualiza orden de produccion
    $('#guardar1').click(function() {
            $.ajax({
                type: "POST",
                url: "actualizar_orden_produccion.php",
                data: $("#mainform1").serialize(),
                success: function(result) {
                    console.log(result);
                }

            })
            location.reload();
        })
        //Elimina orden de produccion
        //PENDIENTE: Revisar validacion de borrado con foraneas
    $('#eliminar1').click(function() {
        var x = document.getElementById("id_produccion2").value;
        $.ajax({
            type: "POST",
            url: "borrar_orden_produccion.php",
            data: $("#frmEliminarUsuario").serialize()
        })
        window.location = 'tablero.html'
    });
    $('#guardar').click(function() {
        $.ajax({
            type: "POST",
            url: "guardar_orden_produccion.php",
            data: $("#mainform").serialize()
        })
        window.location = 'tablero.html'
    });


    //Obtiene datos para ponerlos en modal de edicion de orden de produccion
    var obtener_datos = function(tbody, table) {
            $(tbody).on("click", "button.editar", function() {
                var data = table.row($(this).parents("tr")).data();
                var id_maquina = $("#id_produccion1").val(data.id_produccion),
                    tipo_produccion = $("#tipo_produccion1").val(data.tipo_produccion),
                    fecha_solicitud = $("#cuando_solicito1").val(data.fecha_solicitud),
                    orden_produccion = $("#orden_produccion1").val(data.orden_produccion),
                    numero_parte = $("#numero_parte1").val(data.numero_parte),
                    cantidad_requerida = $("#cantidad_requerida1").val(data.cantidad_requerida),
                    fecha_requerida = $("#fecha_requerida1").val(data.fecha_requerida),
                    numero_operacion = $("#numero_operacion1").val(data.numero_operacion),
                    UPH = $("#UPH1").val(data.UPH),
                    fecha_inicio = $("#fecha_inicio1").val(data.fecha_inicio),
                    fecha_fin = $("#fecha_fin1").val(data.fecha_fin);
            });
        }
        //Pone datos en modal para eliminar
    var obtener_datos_eliminar = function(tbody, table) {
        $(tbody).on("click", "#eliminamesta", function() {
            var data = table.row($(this).parents("tr")).data();
            var id_maquina = $("#id_produccion2").val(data.id_produccion);
        });

    }

    $(".cerrarModal").click(function() {
        $("#modalEditar").modal('hide')

    });
    $("#btnOperador").on("click", function() {
        listarOperador();
        $("#modalOperador").modal()
    });


    function goBack() {
        window.history.back();
    }

    //funcion para obtener datos de la tabla para la forma 72
    var obtener_orden = function(tbody, table) {
        $(tbody).on("click", "#forma", function() {
            var data1 = table.row($(this).parents("tr")).data();
            //Asigna id_produccion y orden de produccion a campos en la forma 72
            $("#orden_72").val(data1.orden_produccion);
            $("#id_orden").val(data1.id_produccion);
            var actual = moment().format('YYYY-MM-DD');
          $("#fechaactual").text(actual);
            $("#modal_dash").modal();
        })
    }
    var obtener_datos_calidad = function(tbody, table) {
        $(tbody).on("click", "#calidad", function() {
            var data1 = table.row($(this).parents("tr")).data();
            //Asigna id_produccion a modal calidad
            var orden = $("#ordendeproduccion").val(data1.id_produccion);
            listacalidad($("#ordendeproduccion").val());
            $("#modalcalidad").modal();
        })
    }

    //Abre modal para seleccionar el empleado
    $("#seleccionaempleado").on("click", function() {
        listaempleados();
        $("#modalempleados").modal();
    });

    //Muestra la tabla de calidad 
    var listacalidad = function(orden) {
        var table = $("#tabla_calidad").DataTable({
            "destroy": true,
            "paging": false,
            "bInfo": false,
            "responsive": true,
            "ajax": {
                "method": "POST",
                "url": "lista_calidad.php",
                "data": {
                    id_orden: orden
                }
            },
            "columns": [{
                "data": "id_calidad"
            }, {
                "data": "id_operacion"
            }, {
                "data": "responsable"
            }, {
                "data": "fecha_liberacion"
            }, {
                "data": "tiempo_liberacion"
            }, {
                "defaultContent": "<button id='edita_calidad'>Editar</button>"
            }]
        });
        obtener_datos_edita_calidad("#tabla_calidad tbody", table);
    }
    var obtener_datos_edita_calidad = function(tbody, table) {
        $(tbody).on("click", "#edita_calidad", function() {
            var data1 = table.row($(this).parents("tr")).data();
            var calidad = data1.id_calidad;
            var responsable = data1.responsable;
            var fecha_liberacion = data1.fecha_liberacion;
            var tiempo_liberacion = data1.tiempo_liberacion;
            $("#resp").val(responsable);
            $("#fechalib").val(fecha_liberacion);
            $("#tiempolib").val(tiempo_liberacion);
            $("#id_calidad").val(calidad);
            $("#modaleditacalidad").modal();
        });
    }


    //Muestra la tabla de operadores en el modal.
    var listaempleados = function() {
        var table = $("#tablaempleados").DataTable({
            "destroy": true,
            "paging": false,
            "bInfo": false,
            "responsive": true,
            "ajax": {
                "method": "POST",
                "url": "lista_operador.php"
            },
            "columns": [{
                "data": "id_operador"
            }, {
                "data": "nombre_operador"
            }, {
                "data": "apellido_operador"
            }, {
                "data": "turno"
            }, {
                "defaultContent": "<button id='seleccionaoperador'>Seleccionar</button>"
            }]
        });
        obtener_datos_operador("#tablaempleados tbody", table);
    }

    //obtiene datos de operador seleccionando 
    var obtener_datos_operador = function(tbody, table) {
            $(tbody).on("click", "#seleccionaoperador", function() {
                var data1 = table.row($(this).parents("tr")).data();
                var operador = data1.id_operador;
                var nombre = data1.nombre_operador;
                $("#nombre_empleado").val(nombre);
                $("#id_empleado").val(operador);
                $("#modalempleados").modal('hide');
            });
        }
        //Funcion para guardar datos de calidad
    $("#guarda_calidad").on("click", function() {
        var op = $("#ordendeproduccion").val();
        var nombre = $("#nombre_calidad").val();
        var fecha = $("#fecha_calidad").val();
        var tiempo = $("#tiempo_liberacion").val();
        //comprobacion si es un numero de minutos ingresado es entero
        if (Number.isInteger(parseInt(tiempo)) || Math.sign(parseInt(tiempo)) == 1) {
            var query = "INSERT INTO calidad VALUES (NULL," + op + ",'" + nombre + "','" + fecha + "'," + tiempo + ");"
            $.ajax({
                type: "POST",
                url: "consulta_calidad.php",
                data: {
                    id_orden: op
                },
                success: function(data) {

                    if (data == "NO REGISTRADO") {
                        $.ajax({
                            type: "POST",
                            url: "guarda_registro72.php",
                            data: {
                                query: query
                            }
                        });
                        location.reload();
                    } else {
                        alert("Solo se puede guardar una liberacion por orden de produccion");
                    }
                }
            })
        } else {
            alert("Introduzca un numero de minutos entero");
        }
    });

    //funciones para cerrar modals
    $("#cerrar72").on("click", function() {
        $("#modal_dash").modal('hide');
    })
    $("#cerrarempleado").on("click", function() {
        $("#modalempleados").modal('hide');
    })
    $("#cerrarregistro").on("click", function() {
        $("#modaldeforma72").modal('hide');
    })

    $("#closemodalparo").on("click", function() {
        $("#modalparo").modal('hide');
    })
    $("#cerrar72").on("click", function() {
        $("#modal_dash").modal('hide');
    })
    $("#cerrarcalidad").on("click", function() {
        $("#modalcalidad").modal('hide');
    })
    $("#closemodaleditacalidad").on("click", function() {
        $("#modaleditacalidad").modal('hide');
    })
    $("#cerrar_herramentacion").on("click", function() {
            $("#modalHerramentacion").modal('hide');
        })
        //Funcion para agregar registro como fila a la tabla 
    function agregarFila72(fechaini, fechafin, cantidad, reproceso, scrap) {
        var htmlTags1 = '<tr>' +
            '<td class="inicio1">' + fechaini + '</td>' +
            '<td class="fin1">' + fechafin + '</td>' +
            '<td class="cantidad1">' + cantidad + '</td>' +
            '<td class="reproceso1">' + reproceso + '</td>' +
            '<td class="scrap1">' + scrap + '</td>' +
            '</tr>';
        $('#tabla72 tbody:last-child').append(htmlTags1);
    }
    //Funciones para incluir el datetime
    $('.datetime').daterangepicker({
        timePicker: true,
        startDate: moment().startOf('hour'),
        endDate: moment().startOf('hour').add(32, 'hour'),
        locale: {
            format: 'YYYY-MM-DD HH:mm'
        }
    });
    $('.time').daterangepicker({
        timePicker: true,
        startDate: moment().startOf('hour'),
        endDate: moment().startOf('hour').add(32, 'hour'),
        locale: {
            format: 'HH:mm'
        }
    });
    $('.onlydate').daterangepicker({
        "singleDatePicker": true,
        "timePicker": true,
        startDate: moment().startOf('hour'),

        locale: {
            format: 'DD/MM/YY hh:mm A '
        }
    }, function(start, end, label) {
        console.log("New date range selected: ' + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD') + ' (predefined range: ' + label + ')");
    });
    $('.onlydate2').daterangepicker({
        "singleDatePicker": true,
        "timePicker": true,
        startDate: moment().startOf('hour'),

        locale: {
            format: 'DD/MM/YY hh:mm A '
        }
    }, function(start, end, label) {
        console.log("New date range selected: ' + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD') + ' (predefined range: ' + label + ')");
    });
    //Funcion para obtener datos del modal del registro 72
    $("#guardaentabla").on("click", function() {
        var uno = $("#rango").val();
        var inicio = uno.substring(0, 16);
        var fin = uno.substring(19, 35);
        var cantidad = $("#progress").val();
        var reproceso = $("#reproceso").val();
        var scrap = $("#scrap").val();
        agregarFila72(inicio, fin, cantidad, reproceso, scrap);
        $("#modaldeforma72").modal('hide');
    });
    //Funcion para obtener datos de paro del modal y ponerlos en la tabla
    $("#guardaparo").on("click", function() {
        var datetimes = $("#tiempoparo").val();
        var inicio = new Date(datetimes.substring(0, 16));
        var fin = new Date(datetimes.substring(19, 35));
        var diff = Math.abs(fin - inicio) / 36e5;
        var comentario = $("#comment").val();
        var htmlTags2 = '<tr>' +
            '<td class="diferencia">' + diff + '</td>' +
            '<td class="comentario">' + comentario + '</td>' +
            '</tr>';
        $('#tablaparos tbody:last-child').append(htmlTags2);
        $("#modalparo").modal('hide');
    })
</script>


<script src="js/jquery-1.12.3.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.dataTables.min.js"></script>
<script src="js/dataTables.bootstrap.js"></script>
<!--botones DataTables-->
<script src="js/dataTables.buttons.min.js"></script>
<script src="js/buttons.bootstrap.min.js"></script>
<!--Libreria para exportar Excel-->
<script src="js/jszip.min.js"></script>
<!--Librerias para exportar PDF-->
<script src="js/pdfmake.min.js"></script>
<script src="js/vfs_fonts.js"></script>
<!--Librerias para botones de exportación-->
<script src="js/buttons.html5.min.js"></script>


</html>